{"componentChunkName":"component---src-templates-article-js","path":"/van/electrical/BMS_wiring_logic_v0/REC_Q_BMS_Wiring_Logic_V0/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"type\": \"article\",\n  \"section\": \"van\",\n  \"categories\": [\"electrical\"],\n  \"navTitle\": null,\n  \"title\": \"REC Q BMS Wiring and Logic V0\",\n  \"author\": \"Nate\",\n  \"date\": \"2020-10-26T00:00:00.000Z\",\n  \"tags\": [\"BMS\", \"battery\", \"design\", \"concept\", \"electrical\", \"van\", \"deprecated\"],\n  \"metatags\": [\"deprecated\"],\n  \"cover\": {\n    \"img\": \"rec-bms.jpeg\"\n  },\n  \"tldr\": \"This design is obsolete and deprecated. This was our zeroth version of the BMS Wiring and Logic design.  It reflected the use of a latching remote battery switch and thus relied on a the REC Bistable Latching Relay Driver (BSLRD) and a custom designed REC BLSRD Inverter.  A shift was made to a Blue Sea Branded latching remote battery switch that with internal circuitry to present as a normally open contactor.  This eliminated the need for the REC BSLRD and associated inverter.\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  .grvsc-container {\\n    overflow: auto;\\n    position: relative;\\n    -webkit-overflow-scrolling: touch;\\n    padding-top: 1rem;\\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\\n    padding-bottom: 1rem;\\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\\n    border-radius: 8px;\\n    border-radius: var(--grvsc-border-radius, 8px);\\n    font-feature-settings: normal;\\n    line-height: 1.4;\\n  }\\n  \\n  .grvsc-code {\\n    display: table;\\n  }\\n  \\n  .grvsc-line {\\n    display: table-row;\\n    box-sizing: border-box;\\n    width: 100%;\\n    position: relative;\\n  }\\n  \\n  .grvsc-line > * {\\n    position: relative;\\n  }\\n  \\n  .grvsc-gutter-pad {\\n    display: table-cell;\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  .grvsc-gutter {\\n    display: table-cell;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter::before {\\n    content: attr(data-content);\\n  }\\n  \\n  .grvsc-source {\\n    display: table-cell;\\n    padding-left: 1.5rem;\\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\\n    padding-right: 1.5rem;\\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\\n  }\\n  \\n  .grvsc-source:empty::after {\\n    content: ' ';\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter + .grvsc-source {\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  /* Line transformer styles */\\n  \\n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\\n    content: ' ';\\n    position: absolute;\\n    width: 100%;\\n  }\\n  \\n  .grvsc-line-diff-add::before {\\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\\n  }\\n  \\n  .grvsc-line-diff-del::before {\\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\\n  }\\n  \\n  .grvsc-line-number {\\n    padding: 0 2px;\\n    text-align: right;\\n    opacity: 0.7;\\n  }\\n  \\n\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"This design is obsolete and deprecated. This was our zeroth version of the BMS Wiring and Logic design.  It reflected the use of a latching remote battery switch and thus relied on a the REC Bistable Latching Relay Driver (BSLRD) and a custom designed REC BLSRD Inverter.  A shift was made to a Blue Sea Branded latching remote battery switch that with internal circuitry to present as a normally open contactor.  This eliminated the need for the REC BSLRD and associated inverter.\")), mdx(\"h1\", null, \"REC Q BMS Wiring Logic\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/703fd5cf4a2d63c170b9fb285a1d40f6/REC_Q_BMS_Wiring_Logic.svg\",\n    \"alt\": \"REC Q BMS Wiring Logic\"\n  })), mdx(\"h2\", null, \"Operation\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ON\")), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual_REC_Victron_BMS.pdf\"\n  }, \"REC Q BMS\"), \" is always attached, Internal relay is normally closed. When Remote Switch (RS) is closed, Vbat is applied through internal relay, through RS, to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManualPrechargeNew.pdf\"\n  }, \"REC PRE-CHARGE\"), \" (RPC) BMS+ Input. RPC Applies VBat via 66 ohm relay to load side of contactor via System + connection for x seconds. After x seconds, RPC energizes Contactor - via an open collector, and will continue to do so. This signal is applied continuously to the Input of the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual_BSLRD.pdf\"\n  }, \"REC Bi-Stable Latching Relay Driver\"), \" (RBSLRD). \"), mdx(\"p\", null, \"Upon first application, the RBSLRD will produce a 100 msec GND pulse on Set Relay Coil -. This signal is inverted by the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/van/electrical/REC_BSLRD_inverter_deprecated/REC_BSLRD_inverter\"\n  }, \"RBLSRD inverter\"), \" to a 100 msec Vbat signal that is applied to the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://assets.bluesea.com/files/resources/instructions/980035680-001-7701100-7703100.pdf\"\n  }, \"BlueSea Remote Battery Switch\"), \" (RBS) CLOSE input, which closes the RBS contactor. \"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"OFF\")), mdx(\"p\", null, \"When the RS is opened, or the REC Q internal relay is opened*, Vbat is removed from the RPC BMS+ input. The RPC will float its Contactor - output and continue to do so. When the RBSLRD Input pin floats, the RBSLRD will produce a 100 msec GND pulse on Reset Relay Coil -. This signal is inverted to a 100 msec Vbat signal that is applied to the RBS OPEN input, which opens the RBS contactor.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"*\", \"The following events result in the REC Q Internal Relay opening\")), mdx(\"p\", null, \"Cell Voltage High (cell over voltage switch-off + hysteresis)\"), mdx(\"p\", null, \"Cell Voltage Low (cell under voltage protection switch-off + hysteresis)\"), mdx(\"p\", null, \"Cell Temp High (cell over temp switch-off + hysteresis) \"), mdx(\"p\", null, \"Number of cells or BMS address is not set properly\"), mdx(\"p\", null, \"Temperature sensor error (connection problem)\"), mdx(\"p\", null, \"Cell Short Circuit or BMS measurement error\"), mdx(\"p\", null, \"Main Relay is in short circuit\"), mdx(\"p\", null, \"Current measurement disabled or > 2x shunt max current\"), mdx(\"p\", null, \"Wrong Cell Chemistry Selected\"), mdx(\"p\", null, \"Cell balancing or measurement failure\"), mdx(\"p\", null, \"BMS internal comm failure\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Note:\"), \" The internal relay is NOT opened under Temperature Low (under temperature charging disable + hysteresis) conditions.  We will use charger enable signal to provide hardware backup protection of low temperature charging under loss of CAN conditions.\"), mdx(\"h2\", null, \"Over Voltage Backup Protection\"), mdx(\"p\", null, \"This is accomplished by the disconnection of the Main Contactor by the BMS via its internal relay.\"), mdx(\"h2\", null, \"Under Voltage Backup Protection\"), mdx(\"p\", null, \"This is accomplished by the disconnection of the Main Contactor by the BMS via its internal relay.\"), mdx(\"h2\", null, \"Low Temp BackUp Protection\"), mdx(\"p\", null, \"This is accomplished by disabling each charging source by the BMS via its charger enable opto-coupler.\"), mdx(\"h3\", null, \"MPPT\"), mdx(\"p\", null, \"From the 150/XX MPPT Manual\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"3.5 Remote on-off\"), \" \"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"The left terminal is connected to the internal 3,3V supply, with a resistor in series for short circuit protection. The right terminal (marked as + or marked as H) will switch the controller on if >3V is applied, and will switch the controller off if <2V is applied or if the terminal is left free floating. The recommended use of the remote on-off is: \"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"a. A switch wired between the left and right terminal \"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"b. A switch wired between battery plus and the right terminal. \"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"c) A switch between the right terminal and the charge disconnect terminal of a VE.Bus BMS\")), mdx(\"p\", null, \"The REC documentation describes the charger enable as open collector and open emitter, and also as an opto-coupler.  Based on this, wire the left terminal of the MPPT to BMS Charger Enable (1), and wire the right terminal of the MPPT to the BMS Charger Enable (2).  This will provide fail safe remote shutdown (ie wire becomes disconnected and floats right terminal of MPPT will shut down).\"), mdx(\"h3\", null, \"Multiplus\"), mdx(\"p\", null, \"One possibility is to use the Charge current control assistant\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Another possibility is to use the Two-signal BMS support assistant.\"), \"   Select \\\"The BMS has one contact which which switches only on a high-cell condition\\\".   Then \\\"The battery is full when \", \"[Aux1/Aux2]\", \" is \", \"[open/closed]\", \"\\\".  Lastly \\\"\", \"[Disable Charger]\", \" and \", \"[do not adapt SOC]\", \" when battery full.\\\"  This could use the REC charger enable opto-coupler, but not in parallel with the MPPT.   Thus we need to branch the REC signal.\"), mdx(\"h3\", null, \"Alternator/Wakespeed\"), mdx(\"p\", null, \"From the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://wakespeed.com/Quick%20Start.pdf\"\n  }, \"Wakespeed WS500 Quickstart Card\"), \":\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Feature In Wire (White)\"), \" Can be connected to a voltage source greater than 8.5 VDC to enable a range of selectable optional capabilities as detailed in the User\\u2019s Guide\")), mdx(\"p\", null, \"From the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://wakespeed.com/WS500quickstartguide.pdf\"\n  }, \"Wakespeed WS500 Quickstart Guide\"), \":\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Function In \\u2013\"), \" The white 16-gauge Function In can be configured to provide a number of custom controls which can be activated by connecting the wire to >8.5VDC+ via a toggle or other ON/OFF type switch. In default mode, the Function In mode will enable equalize mode when the regulator is configured for lead acid batteries. When the WS500 is configured for LiFeP04 batteries (see DIP switch instructions), Function In will force the system to float.\")), mdx(\"p\", null, \"The wakespeed in stand-along mode can be made to enter a Post-Float mode in which the charger is off but monitoring or a return to bulk.  In the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://wakespeed.com/CU/ConfigurationUtilityGuideWeb.pdf\"\n  }, \"Wakespeed Configuration Utility Guide\"), \" by configuring the \\\"Exit Duration\\\" of the $CPF entry to a small non-zero number like '1' (looks like minutes), the WS500 will quickly exit float.  By configuring the \\\"Exit Duration\\\" of the $CPE entry to zero, equalization will be disabled.  The $CPP entry is used to configure Post-Float behavior.  Fully disabling the charger, and setting a Battery Voltage corresponding to a return to Bulk is possible.  \"), mdx(\"p\", null, \"TODO: This needs verification, but it appears that by custom configuring the Custom Profiles as identified above, on loss of CAN, that profile, selected by DIP switches, is used.  That behavior in conjuction with the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Feature In\"), \" would allow the BMS charger enable signal to disable alternator/Wakespeed charging.\"), mdx(\"p\", null, \"TODO: Determine if \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Function In\"), \" is active high or low.  Specifically, if >8.5V is present, does it force to float, or force to float when >8.5V is not present.\"), mdx(\"p\", null, \"TODO: Determine which ground the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Function In\"), \" is referenced to.  Determine max input current draw of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Function In\"), \".\"), mdx(\"h3\", null, \"All Together\"), mdx(\"p\", null, \"TODO: Since we need separate dry contacts or opto-couplers for two components, we will need a \\\"splitter\\\".  A starting place would be \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.sparkfun.com/products/9118\"\n  }, \"this sparkfun opto-isolator breakout\"), \".  TODO: Since we need a >8.5v DC 'wet' signal we will also need some conditioning.  Could possibly use the RBSLD inverter.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"REC Q BMS Wiring and Logic V0","cover":{"img":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/5c118/rec-bms.jpg","srcSet":"/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/caa96/rec-bms.jpg 916w,\n/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/c035a/rec-bms.jpg 1832w,\n/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/5c118/rec-bms.jpg 3664w","sizes":"(min-width: 3664px) 3664px, 100vw"},"sources":[{"srcSet":"/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/f9c21/rec-bms.webp 916w,\n/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/7e1d5/rec-bms.webp 1832w,\n/static/d87a54848dd6e98d7b50ecf2b9ee1bc9/0586d/rec-bms.webp 3664w","type":"image/webp","sizes":"(min-width: 3664px) 3664px, 100vw"}]},"width":3664,"height":2748}}}}}}},"pageContext":{"slug":"/van/electrical/BMS_wiring_logic_v0/REC_Q_BMS_Wiring_Logic_V0/"}},"staticQueryHashes":["2882470331","3528462622","3692595610"]}