{"componentChunkName":"component---src-templates-post-js","path":"/blog/2021-4-08-rpi-to-rec-comms/rpi-to-rec-q-can-comms/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"type\": \"post\",\n  \"section\": \"blog\",\n  \"categories\": [\"electrical\"],\n  \"navTitle\": null,\n  \"title\": \"RPi to REC Q CAN Comms\",\n  \"author\": \"Nate\",\n  \"date\": \"2021-04-08T00:00:00.000Z\",\n  \"tags\": [\"electrical\", \"test\", \"bms\", \"battery\"],\n  \"metatags\": null,\n  \"cover\": {\n    \"img\": \"rpi-to-rec-q-can-comms.jpg\"\n  },\n  \"tldr\": \"We setup an RPi to communicate over CAN with our REC Q BMS.  This will allow us to log BMS parameters during electrical system testing.It will also lay the ground work for interfacing our homebrew electrical monitoring and control functions with the BMS.\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  .grvsc-container {\\n    overflow: auto;\\n    position: relative;\\n    -webkit-overflow-scrolling: touch;\\n    padding-top: 1rem;\\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\\n    padding-bottom: 1rem;\\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\\n    border-radius: 8px;\\n    border-radius: var(--grvsc-border-radius, 8px);\\n    font-feature-settings: normal;\\n    line-height: 1.4;\\n  }\\n  \\n  .grvsc-code {\\n    display: table;\\n  }\\n  \\n  .grvsc-line {\\n    display: table-row;\\n    box-sizing: border-box;\\n    width: 100%;\\n    position: relative;\\n  }\\n  \\n  .grvsc-line > * {\\n    position: relative;\\n  }\\n  \\n  .grvsc-gutter-pad {\\n    display: table-cell;\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  .grvsc-gutter {\\n    display: table-cell;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter::before {\\n    content: attr(data-content);\\n  }\\n  \\n  .grvsc-source {\\n    display: table-cell;\\n    padding-left: 1.5rem;\\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\\n    padding-right: 1.5rem;\\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\\n  }\\n  \\n  .grvsc-source:empty::after {\\n    content: ' ';\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter + .grvsc-source {\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  /* Line transformer styles */\\n  \\n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\\n    content: ' ';\\n    position: absolute;\\n    width: 100%;\\n  }\\n  \\n  .grvsc-line-diff-add::before {\\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\\n  }\\n  \\n  .grvsc-line-diff-del::before {\\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\\n  }\\n  \\n  .grvsc-line-number {\\n    padding: 0 2px;\\n    text-align: right;\\n    opacity: 0.7;\\n  }\\n  \\n  .monokai-dimmed {\\n    background-color: #1e1e1e;\\n    color: #c5c8c6;\\n  }\\n  .monokai-dimmed .mtk1 { color: #C5C8C6FF; }\\n  .monokai-dimmed .grvsc-line-highlighted::before {\\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\\n  }\\n\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR: We setup an RPi to communicate over CAN with our REC Q BMS.  This will allow us to log BMS parameters during electrical system testing.It will also lay the ground work for interfacing our homebrew electrical monitoring and control functions with the BMS.\")), mdx(\"h3\", null, \"Getting an RPi talking to the REC Q BMS\"), mdx(\"p\", null, \"I wanted to be able to wring out the protections and comms with the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"\"\n  }, \"REC Q BMS\"), \" ahead of hooking it up to a large stored power source (and because I'm still awaiting delivery of said large stored power source).\"), mdx(\"p\", null, \"Ultimately, I would like all the battery time series data to be logged by a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"\"\n  }, \"Signal-K\"), \" database which will necessitate some device that can translate the information the REC Q relays via CAN to a format compatible with Signal-K's schema for battery data (under development at the time of this post).  That is the why.\"), mdx(\"p\", null, \"Step one for the \\\"How\\\" is getting the RPi to receive the messages. Decoding, and doing something with those messages will be a step two thing.  I'm using a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://copperhilltech.com/pican3-can-bus-board-for-raspberry-pi-4-with-3a-smps-and-rtc/\"\n  }, \"PiCAN3\"), \" left over from a ODBII project I was working on in conjunction with a RPi 4 that I'm using for logging and all the comms with the test equipment.  \"), mdx(\"p\", null, \"What follows is pretty much verbatim from the PiCAN setup \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://skpang.co.uk/catalog/images/raspberrypi/pican/PICAN3_UGA_10.pdf\"\n  }, \"instructions\"), \":\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo apt-get update\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo apt-get upgrade\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo reboot\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo nano /boot/config.txt\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Add these lines at the end of the file:\"))), mdx(\"pre\", {\n    \"className\": \"grvsc-container monokai-dimmed\",\n    \"data-language\": \"bash\",\n    \"data-index\": \"0\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"dtparam=spi=on\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"dtoverlay=mcp2515-can0,oscillator=16000000,interrupt=25\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"dtoverlay=spi-bcm2835-overlay\"))))), mdx(\"ol\", {\n    \"start\": 6\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo reboot\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo apt-get install can-utils\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start up the BMS.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Bring up the CAN interface to 250kbps \", mdx(\"del\", {\n    parentName: \"p\"\n  }, \"(The \", mdx(\"a\", {\n    parentName: \"del\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual_REC_Q.pdf\"\n  }, \"REC Q manual\"), \" is wrong)\"), \":\"))), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo ip link set can0 up type can bitrate 250000\")), mdx(\"ol\", {\n    \"start\": 10\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"candump can0\"))), mdx(\"p\", null, \"Boom!\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container monokai-dimmed\",\n    \"data-language\": \"bash\",\n    \"data-index\": \"1\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  380   [8]  31 51 2D 31 38 34 35 00\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  351   [8]  1F 01 BC 02 E8 03 E7 00\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  355   [6]  32 00 64 00 88 13\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  356   [6]  32 0A 00 00 27 01\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  35A   [8]  A8 A0 82 00 00 00 80 0A\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  35E   [8]  52 45 43 2D 42 4D 53 00\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  35F   [8]  00 00 02 06 64 00 00 00\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"can0  351   [8]  1F 01 BC 02 E8 03 E7 00\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"...\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"...\"))))), mdx(\"h3\", null, \"Findings\"), mdx(\"p\", null, \"The REC Q manual isn't wrong afterall.  Turns out I was using a manual that documents a different version of firmware that changes both the CAN baudrate, but also uses a completely different schema for CAN.  This can be seen from the CAN IDs that are reported from the RPi:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"800px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/7f43cfd14b237ff8942241925b44dfbf/49b61/cansniffer.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"55.00000000000001%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2ElEQVQoz6WR3YrTQBTHR+gighcLHaEkM/lQWtukTdwmbptkJp9t0s12W/oEPoXXPodvoHix94IoeCVoL7zzHZRclzYcSWgLwq6yeOAHM2c4v/OHQa9fjNHENh45zHysDQzFfHam8niqRnGiXuSXahgl6vPRWGV+UPccj6mM+2qaXaiOy1SPccVj/hPGg2Z+eYWqup/x8ft44m6Glv3rbGgVw/NxcT4aFWPHKRjnhcdYEYRhTRhFBeN+MbSsotvTCk3Tf2qavnva7b5D+zqdpOn3+fwKXNeFIAggjiKwbRs0TYNOpwOyLIMiyyBLEiiKUt9FUQRCSA2lBARB+FyFq4VZmn5bLBbgMbYNw7CM47icTqel7/ulZVklIaSklP6BJEkHtpIkVQs+HoVpmq7n8zk4jrOLogiSJIEsy4BzXqeklEI1dBOU0t1e+OkozPN8vVqtwPO83Ww2g0q+XC7B931ot9u3ym4Vmqa5tiwLdF3f9ft9MAwDTNOEwWAAvV7vbgkbjcZpq9X6KghC1dyIorgVBKGmOhNCtpTSv7HZCz8cE1JKfxx+7yaqgX+9EUK+HIQPMMavMMbXGOM3GOO3d6SauW42my8RQo1KeA8hdIIQevifnGCM0W8Q9/I4tiFbmQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cansniffer\",\n    \"title\": \"cansniffer\",\n    \"src\": \"/static/7f43cfd14b237ff8942241925b44dfbf/5a190/cansniffer.png\",\n    \"srcSet\": [\"/static/7f43cfd14b237ff8942241925b44dfbf/772e8/cansniffer.png 200w\", \"/static/7f43cfd14b237ff8942241925b44dfbf/e17e5/cansniffer.png 400w\", \"/static/7f43cfd14b237ff8942241925b44dfbf/5a190/cansniffer.png 800w\", \"/static/7f43cfd14b237ff8942241925b44dfbf/c1b63/cansniffer.png 1200w\", \"/static/7f43cfd14b237ff8942241925b44dfbf/29007/cansniffer.png 1600w\", \"/static/7f43cfd14b237ff8942241925b44dfbf/49b61/cansniffer.png 1756w\"],\n    \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The IDs above don't match the IDs listed in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual_REC_Q.pdf\"\n  }, \"this version\"), \" of the BMS manual:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"11-bit TX identifiers: 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037 and 0x038.\")), mdx(\"p\", null, \"But they do match the IDs listed in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual_REC_Victron_BMS.pdf\"\n  }, \"this version\"), \":\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"11-bit TX identifiers: 0x351, 0x355, 0x356, 0x35A, 0x35B, 0x35E, 0x35E, 0x370, 0x373, 0x374, 0x375, 0x376, 0x377, 0x379 and 0x380.\")), mdx(\"p\", null, \"The bummer is that in the correct manual version, it doesn't provide any schema to interpret the CAN data beyond listing the IDs.  However, by leveraging a few different sources, I think it can be pieced together because it uses a CAN schema associated with a company called Sunny Island that makes inverters that several BMS's.\"), mdx(\"p\", null, \"The most useful is another product \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.rec-bms.com/datasheet/UserManual9R_SMA.pdf\"\n  }, \"manual\"), \" from REC.  It covers CAN IDs:  0x351, 0x355, 0x356, 0x35A, 0x35B, 0x35E, 0x35F.  Some of the schema's it gives do not appear to match what my BMS is putting out however.  Note: Years ago a very helpful Victron engineer passed this additional detail along:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"There is a mistake in this document. It has max charging current twice in 0x351. The second one is actually the max DIScharge current.\")), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.elithion.com/lithiumate/php/controller_can_specs.php\"\n  }, \"Elithion\"), \" covers CAN IDs: 0x351, 0x355, 0x356, 0x35A.\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/Tom-evnut/SimpBMS/blob/master/Simp%20BMS%20Setup%20Manual%20V0.25.pdf\"\n  }, \"SIMPBMS\"), \" covers CAN IDs:  0x351, 0x355, 0x356, 0x35A, and 0x373.\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/63e39e68246788662b6ef2be6dcbe023/literminal-docu-en-sm-sma-canbus.pdf\"\n  }, \"LiTerminal\"), \" covers CAN IDs: 0x351, 0x355, 0x356, 0x35A, 0x35B, 0x35E, and 0x35F.\"), mdx(\"p\", null, \"I've also got an email into REC.  So hopefully they can help in a more direct way.\"), mdx(\"h3\", null, \"Update \", \"[2021-4-10]\"), mdx(\"p\", null, \"I wrote a python script that parses/translates the IDs for which I have documentation for into something readable.  Script is here:\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/natecostello/REC-BMS_CAN\"\n  }, \"https://github.com/natecostello/REC-BMS_CAN\")), mdx(\"p\", null, \"Sample Output:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"800px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/aa932e45450ea80c21add3b571b532d5/6cfc6/output.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"38.99999999999999%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAaYhtA//xAAZEAACAwEAAAAAAAAAAAAAAAABBAAREhP/2gAIAQEAAQUCIYvLEU3x/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAABEDIjFB/9oACAEBAAY/AskMlLtvp//EABsQAAIBBQAAAAAAAAAAAAAAAAABESExUWHx/9oACAEBAAE/IZ2L+TqMRKKybn//2gAMAwEAAgADAAAAEAPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAgICAwAAAAAAAAAAAAAAAREAMUFRYXHw/9oACAEBAAE/EGdFqNX3Nnq5i1RYiUxc/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"output\",\n    \"title\": \"output\",\n    \"src\": \"/static/aa932e45450ea80c21add3b571b532d5/4b190/output.jpg\",\n    \"srcSet\": [\"/static/aa932e45450ea80c21add3b571b532d5/e07e9/output.jpg 200w\", \"/static/aa932e45450ea80c21add3b571b532d5/066f9/output.jpg 400w\", \"/static/aa932e45450ea80c21add3b571b532d5/4b190/output.jpg 800w\", \"/static/aa932e45450ea80c21add3b571b532d5/e5166/output.jpg 1200w\", \"/static/aa932e45450ea80c21add3b571b532d5/b17f8/output.jpg 1600w\", \"/static/aa932e45450ea80c21add3b571b532d5/6cfc6/output.jpg 1948w\"],\n    \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h3\", null, \"Update \", \"[2021-4-12]\"), mdx(\"p\", null, \"Of the CAN-IDs not covered in the documents:\"), mdx(\"p\", null, \"0x370 is a Model ID of sort.\"), mdx(\"p\", null, \"0x380 is a unit serial number.\"), mdx(\"p\", null, \"Speculation:\"), mdx(\"h4\", null, \"35F\"), mdx(\"p\", null, \"35F is listed in the LiTerminal Docs:\"), mdx(\"p\", null, \"Bits 2 and 3 are listed as by LiTerminal as \\\"BMS Version\\\".  Bits 2 and 3 are listed by REC in the other manual as \\\"Hardware Version\\\" low and high byte. and currently are 0x02 0x06. If I used the same little endian format as most other parameters it resolves to 1538.  If I treat them as direct number, they are 2 and 6, which matches the BMS software version, \\\"2.6\\\", listed on via the wifi interface.  So that is that.\"), mdx(\"p\", null, \"Bits 4 and 5 are listed as \\\"Bat-Capacity\\\".  and currently read 0x03 0x00.  if I used the same little endian format as most other parameters, it resolves to 3 right now.  Previously initially it was 100.  Based on this I think this value is remaining capacity in AH.  I reset the current SOC to 100, and bits 4 and 5 are now 0xFA and 0x00 which resolves to 250AH, which is where I set the capacity.  I changed capacity to 200AH, and these bits  are now reads 0xC8 0x00, which resolves to 200.  so that is that.\"), mdx(\"p\", null, \"No other bits are used by the REC Q for 35F\"), mdx(\"h4\", null, \"379\"), mdx(\"p\", null, \"All zeros except first byte\"), mdx(\"p\", null, \"Rated AH, calculated as LSB MSB for 0-250,  and LSB MSB + 1 for > 250AH (weird).  That is that.\"), mdx(\"h4\", null, \"374\"), mdx(\"p\", null, \"All zeros except first byte\"), mdx(\"p\", null, \"0x33 (51)\"), mdx(\"h4\", null, \"375\"), mdx(\"p\", null, \"All zeros except first byte\"), mdx(\"p\", null, \"0x38 (56)\"), mdx(\"h4\", null, \"376\"), mdx(\"p\", null, \"All zeros except first byte\"), mdx(\"p\", null, \"0x31 (49)\"), mdx(\"h4\", null, \"377\"), mdx(\"p\", null, \"All zeros except first byte\"), mdx(\"p\", null, \"0x31 (49)\"), mdx(\"h4\", null));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"RPi to REC Q CAN Comms","cover":{"img":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8c8","images":{"fallback":{"src":"/static/a362596ac36cb010becb90f043cba374/51c19/rpi-to-rec-q-can-comms.jpg","srcSet":"/static/a362596ac36cb010becb90f043cba374/01edf/rpi-to-rec-q-can-comms.jpg 983w,\n/static/a362596ac36cb010becb90f043cba374/e7de7/rpi-to-rec-q-can-comms.jpg 1966w,\n/static/a362596ac36cb010becb90f043cba374/51c19/rpi-to-rec-q-can-comms.jpg 3931w","sizes":"(min-width: 3931px) 3931px, 100vw"},"sources":[{"srcSet":"/static/a362596ac36cb010becb90f043cba374/d4856/rpi-to-rec-q-can-comms.webp 983w,\n/static/a362596ac36cb010becb90f043cba374/dd46a/rpi-to-rec-q-can-comms.webp 1966w,\n/static/a362596ac36cb010becb90f043cba374/11b25/rpi-to-rec-q-can-comms.webp 3931w","type":"image/webp","sizes":"(min-width: 3931px) 3931px, 100vw"}]},"width":3931,"height":2948}}}}}}},"pageContext":{"slug":"/blog/2021-4-08-rpi-to-rec-comms/rpi-to-rec-q-can-comms/"}},"staticQueryHashes":["2882470331","3528462622","3692595610"]}