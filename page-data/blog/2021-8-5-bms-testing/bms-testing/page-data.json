{"componentChunkName":"component---src-templates-post-js","path":"/blog/2021-8-5-bms-testing/bms-testing/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"type\": \"post\",\n  \"section\": \"blog\",\n  \"categories\": [\"electrical\"],\n  \"navTitle\": null,\n  \"title\": \"REC BMS Testing\",\n  \"author\": \"Nate\",\n  \"date\": \"2021-08-05T00:00:00.000Z\",\n  \"tags\": [\"testing\", \"electrical\", \"battery\"],\n  \"metatags\": null,\n  \"cover\": {\n    \"img\": \"mhmv2bmsctf-cover.jpeg\"\n  },\n  \"tldr\": \"We tested and captured data to prove out and characterize the REC BMS protection and operation.  This was based on our previous work to get an RPi to communicate with our Riden power supply, our digital multimeter, and the BMS.\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  .grvsc-container {\\n    overflow: auto;\\n    position: relative;\\n    -webkit-overflow-scrolling: touch;\\n    padding-top: 1rem;\\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\\n    padding-bottom: 1rem;\\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\\n    border-radius: 8px;\\n    border-radius: var(--grvsc-border-radius, 8px);\\n    font-feature-settings: normal;\\n    line-height: 1.4;\\n  }\\n  \\n  .grvsc-code {\\n    display: table;\\n  }\\n  \\n  .grvsc-line {\\n    display: table-row;\\n    box-sizing: border-box;\\n    width: 100%;\\n    position: relative;\\n  }\\n  \\n  .grvsc-line > * {\\n    position: relative;\\n  }\\n  \\n  .grvsc-gutter-pad {\\n    display: table-cell;\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  .grvsc-gutter {\\n    display: table-cell;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter::before {\\n    content: attr(data-content);\\n  }\\n  \\n  .grvsc-source {\\n    display: table-cell;\\n    padding-left: 1.5rem;\\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\\n    padding-right: 1.5rem;\\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\\n  }\\n  \\n  .grvsc-source:empty::after {\\n    content: ' ';\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter + .grvsc-source {\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  /* Line transformer styles */\\n  \\n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\\n    content: ' ';\\n    position: absolute;\\n    width: 100%;\\n  }\\n  \\n  .grvsc-line-diff-add::before {\\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\\n  }\\n  \\n  .grvsc-line-diff-del::before {\\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\\n  }\\n  \\n  .grvsc-line-number {\\n    padding: 0 2px;\\n    text-align: right;\\n    opacity: 0.7;\\n  }\\n  \\n\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR: We tested and captured data to prove out and characterize the REC BMS protection and operation.  This was based on our previous work to get an RPi to communicate with our Riden power supply, our digital multimeter, and the BMS.\")), mdx(\"p\", null, \"Its good practice to test equipment that you will depend on for protection.  Given the cost and stored energy in our battery system, we decided to exercise the key protections provided by the BMS before we hook it up for initial charge.  \"), mdx(\"p\", null, \"We also thought this would be a good project to tie together some of our past code for control and monitoring.  We decided to explore Python's \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unittest\"), \" suite as the tool to implement this testing, recognizing this application is not what that suite is meant for.\"), mdx(\"p\", null, \"TLDR: The REC did fine and performs pretty much as described in the manual except for some minor findings.\"), mdx(\"h2\", null, \"Supporting Code\"), mdx(\"p\", null, \"The following dependencies are used by the test code:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/ShayBox/Riden\"\n  }, \"ShayBox/Riden\"), \": A faster, improved, more-thread-friendly evolution of \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/Baldanos/rd6006\"\n  }, \"Baldanos/rd6006\"), \" used to control the DC power supply used for the test.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/natecostello/instrument_logger\"\n  }, \"natecostello/instrument_logger\"), \":  This module provides an inherited \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Instrument\"), \" interface for all instruments and devices in the testing and provides logging for them all.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/natecostello/riden-status\"\n  }, \"natecostello/riden-status\"), \": This module provides monitoring for the DC power supply.  It inherits the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Instrument\"), \" interface and wraps Shaybox's class.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/natecostello/rec_bms_status\"\n  }, \"natecostello/rec_bms_status\"), \": This module provides monitoring for the CANBUS and Binary outputs of the REC BMS.  It inherits the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Instrument\"), \" interface.\")), mdx(\"h2\", null, \"Test Code\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/natecostello/rec-bms-autotesting\"\n  }, \"natecostello/rec-bms-autotesting\"), \" contains all the test scripts.  It also includes a crude script that will produce readable plots from the CSV files generated by the test scripts.\"), mdx(\"p\", null, \"There are four scripts that test the BMS response to the following conditions:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Rising Cell/Battery Voltage\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Falling Cell/Battery Voltage\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Rising Cell/Battery Temperature\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Falling Cell/Battery Temperature\")), mdx(\"p\", null, \"The voltage related tests are fully automated and vary the cell/battery voltage using the Riden.  The temperature test prompt the user to apply or remove heat or cold at points during the test.  We used ice water and a heat gun.\"), mdx(\"h2\", null, \"Test Hardware\"), mdx(\"p\", null, \"The hardware required for the testing, as we went about it, includes:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Riden RD6018 DC Power Supply\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"REC Q BMS\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Logging Raspberry Pi 4 with a CANBus hat (running all this code)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Battery Simulator\")), mdx(\"p\", null, \"Together, these parts combine like Voltron to form the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"M. Henneberger Memorial Van 2.0 Battery Management System Compatibility Test Facility\"), \" or MHMV2BMSCTF for short.\"), mdx(\"h2\", null, \"Results\"), mdx(\"h3\", null, \"Rising Cell/Battery Voltage\"), mdx(\"p\", null, \"The purpose of this test is to verify the BMS takes protective action to communicate via CANBus to stop charging, to communicate via the CHARGE ENABLE to stop charging, and finally open the main contactor as a last resort to stop charging.  Also, we care whether it does these things at the voltage thresholds it's supposed to.  It did. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/3eb52be09e8f734e6fae8dcc9bed17be/rising_voltage_test.csv\"\n  }, \"CSV data\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"559px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/07bb11f730964ea10e561673556d7fed/a65ce/max-cell-voltage-and-end-of-charge-rising_voltage_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"82.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAC7ElEQVQ4y52U17LrNgxF9f8/d659ii2r92I1iiqkZHslom/ykjxkwpklbAoQOBgKsADKsiTPMvI8NwRBQFEUpGlq9nVdGxvHsdFZllGVJUkckySJ2ctxPFJhHY9lXZHThFKKdV0Zx5FpmpBSmsBJSuZ5pus64xPDgDjsONIfWghWpeD1wqqbBlmWjEVBmCSkWWYIosgEq21j0dpw6PXgOPhIIiUqTVlvNxYpzQGW47o8tg20RtzvTG3L1DS0ec4mJRyl9P0/GQZoO5hn2He43xmGAcvzfUTX0vs+U5IaZJwwJQkySRiqiq6uGY4P7o3RfdMyjCODlLT9QH/oPGPoe6wwDMjSnizt8CMPL/C4eQ6u7+KHPvW9QumFZZ1Z1WysYZnQWtK2kvN5Mr7+SBgEPlo/URr6QRvEuNN1K0JszAtsO8av1t8oWJd3tYf2/beWcsBSaqUq79hfOe5PjXupcb5Lg/tT4XxXXE8ZvnMnTnrCqCMIWoNtd9h2Q5a2ZFmLEANWURY02Z3Kzfk5ffLzccb+/OHy65PL6Ys8TFj6kS6506cN8zCy7yuPlzJsD/1m1++Sj5vZ9wf/ZT03WLqNqVIo8UBPT7Tc0ELz2l+IUWA1TUtVZFTJjfI3eXSliK40hW+oM5cm92irgKbyqVOX3LlQeFeyMCWPcqq8ND+4Nc0LU1+w9BHu7RvX/uR2ORH5V7ZV/DtKsO8T+5SwPzT7Cx7Pp+kk68i6Hdf4f5buQTVv+1SmLa22aYmziC//k7Nz5mT/4nw78XH94BJecBIHO7riJLe3jm1usW20E9tc/A+i5EaSB/RDj6VWRSMaalkTJRGO7xBnMW7g0omO7bmhHxq1K8Oh/9pvzx2hJfe5pVcDXddiHXWLQbDOq5k2m95Yl/XvyTNPs5k8y7ywLIvRx7tDr/PCIHou2YW0Td+9/Hg8qKoK13Np29YEBmFg5pzW2sw/z/NM8OE7ZmIYhiitjC+KIsq65Mjz+nN8/QEDrwdV3JDivgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"max cell rising voltage\",\n    \"title\": \"max cell rising voltage\",\n    \"src\": \"/static/07bb11f730964ea10e561673556d7fed/a65ce/max-cell-voltage-and-end-of-charge-rising_voltage_test.png\",\n    \"srcSet\": [\"/static/07bb11f730964ea10e561673556d7fed/772e8/max-cell-voltage-and-end-of-charge-rising_voltage_test.png 200w\", \"/static/07bb11f730964ea10e561673556d7fed/e17e5/max-cell-voltage-and-end-of-charge-rising_voltage_test.png 400w\", \"/static/07bb11f730964ea10e561673556d7fed/a65ce/max-cell-voltage-and-end-of-charge-rising_voltage_test.png 559w\"],\n    \"sizes\": \"(max-width: 559px) 100vw, 559px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"This plot shows the desired coordination of \\\"soft\\\" software controls acting (Charge Current Limit reduction), then \\\"hard\\\" software controls (Charge Enable low), and then hardware backup\")), mdx(\"h3\", null, \"Falling Cell/Battery Voltage\"), mdx(\"p\", null, \"The purpose of this test is to verify the BMS takes protective action to communicate via CANBus to stop discharging and to open the main contactor as a last resort to stop discharging.  Also, we care whether it does these things at the voltage thresholds it's supposed to.  It did. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/bbb150e8938dbd70ce374e87d16e30ca/falling_voltage_test.csv\"\n  }, \"CSV data\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"559px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/52d4a85bd187ec0744782e87d3dd2ab6/a65ce/min-cell-voltage-and-end-of-discharge-falling_voltage_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"82.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAACm0lEQVQ4y5WU646kNhCFef8n20jJaJNNMs1sdxOMAXO/GDD3L7J7pvMjGWlT0lFdsMquU0V58zwjo4g8y5BSEoYhQgiUUs7PsowoikiSxPkfSNPUIQgCp+358zzxZmMYponRGJw9DPR9zzRNT9tqrTVN09C2rbOttt/quqbrOme7hCrPGfKcTilEHBO94y8h6LsOW4GZJoy9cJ7dpeb98qe2Z2yOpsFL0pRVa468oC9LOqvznEop9vPkh6UoaG1C+/R5WTjNCFUBdQlN6fSWpv9AKbauY+17trZ9+PYxFknCXtc0bYvXNDVFUSJkSSgrZNoikoZEVRRKUVpkGWWaUt5uFG9vlPf7M17YeJ5TVJXj0stzRZ7PBMHKH7+HfP1659tvIZdLjLR8Suk4svIZAR9xl3BZFpZlfQ8dTxTFwbYdnOfxwzRa+jzb9nEYXVKb3JiZeTEoNSPCmTiekdI4RJHF9PQfsQkhDFU1o3WPJ0JBmIa8XF/48usXLuLCNb7iywtxFtM2rZu1D1RV9anvSrazpSfNvM00dcNxPEo0m6FfOv6PuJLHcWRbt38RPKyGcqo5TliPne04nF73lW3fnrC+xXGej4RlWbr/uFAhRXKnykIqFaLi7/x5/Qn//ss7fsYPXngNX/EjH1/4Tl/CCxfxShjf6Lser+8Hxi5j6SQi8Ln536gLyblqzmXgXPQD68Q5ZpzriG38uR8PWNvGTEXX6weH62Jcseu2My8r+/HJxO0azuU/BnGBvaftNJ7tUtt2DMPIMGi3ZaZxZNDabRC7WcZhYBgNupbo/I2hjhhrga5C+lK42NjENG2PZ7u6bRuxlFyvV9d6K3ZV3e934jh2vq3EngmDG7pr7HOpiozg9p08SzmO3a2vvwGDThPSMR6aWgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"min cell voltage falling\",\n    \"title\": \"min cell voltage falling\",\n    \"src\": \"/static/52d4a85bd187ec0744782e87d3dd2ab6/a65ce/min-cell-voltage-and-end-of-discharge-falling_voltage_test.png\",\n    \"srcSet\": [\"/static/52d4a85bd187ec0744782e87d3dd2ab6/772e8/min-cell-voltage-and-end-of-discharge-falling_voltage_test.png 200w\", \"/static/52d4a85bd187ec0744782e87d3dd2ab6/e17e5/min-cell-voltage-and-end-of-discharge-falling_voltage_test.png 400w\", \"/static/52d4a85bd187ec0744782e87d3dd2ab6/a65ce/min-cell-voltage-and-end-of-discharge-falling_voltage_test.png 559w\"],\n    \"sizes\": \"(max-width: 559px) 100vw, 559px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Discharge current limit precedes the contactor as desired.\")), mdx(\"h3\", null, \"Rising Cell/Battery Temperature\"), mdx(\"p\", null, \"The purpose of this test is to verify the BMS takes protective action to communicate via CANBus to stop charging and discharging, communicate via the CHARGE ENABLE to stop charging, and finally open the main contactor as a last resort to stop everything.  Also, we care whether it does these things at the temperature thresholds it's supposed to.  It did. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/1fd83ab4824fb456eddcb59c0bb2f436/rising_temperature_test.csv\"\n  }, \"CSV data\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"570px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/ee8d9d2f8ab344e3eabd1088e07669a8/432e7/max-temperature-rising_temperature_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"81%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACkElEQVQ4y42UiY7jNgyG8/4v184A3Qmy2fi+Y/mQbMmSna+QPLPFosC2BH6RskSal3h5vV58Udd1VFVFnuckSUKeZbRtS1mW4VvqkWUUVUVZ19Rtyz/aJ138Yp1jsxa7bWwezmGMwWwbRmvMuqI9pgk9zxghfsIagz0OnHN45y5SKURZIouCRxwTRRHXtzdu1yttkrAVBbosMVWF8dyjaQJ0XaOjCNP3zPMcjF6GYUBJFdzdtWYvCnYh2P0fj4P/JH9nWdBaY609DY6DwJQ5xnukJMbZEK6/tKwrUkqWZUFJiVLq5F+yUqybDh4ex85lWSR1Lbh+jLy9F/z5nvP+7ouSh0IIIX4qesNSfvHT4DxL0lQxTd7gwWUcB4TwHrzoe8Hz2VHVA3nRM01DKNLvyDfJs4dt+wxZG4OSc8jF6zibYNMv6gqe7Yum3qlKS105mspS5I662hDC0PeGNLb0zx0faSiKj73tWpIq5ZE/iMs48KSKSaqEtM5Iq5SsycjqjKiMiZKWLBsC7mlK2eX4WoS28W52Y0cxFdyTOx/3b3zcP4iKiNUtKKtYrApcO02jGpZdfgVMpUrMfhYweOgXv/m/5I6dQY+fsqNf+yCv63rmcJqm8OT6/onoW8ahp+8a+mfDs6v/xT2u6Tdu+Xdu+Y2ofCB6r9+fVV61ZhQNWjwo4r+Ib38wthFuadlkw6Z+hZU1bs6wm8G6A6tarCxZlpV937ns+4FefU52zGbDwfF6/T7ukMPPV3SooLttDucsF9+c4ziFF+Fln8+vxpVy/qWJz/2CFCWy+4Eaa+bugZoHhmEMwyUUxTdvVZY8Ho/wOrIsCwgjy7fF5/jy3/zwKPKM+MeVIr0TR9/JsvPM5/FviqTHvN0Ibn4AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"max temp rising\",\n    \"title\": \"max temp rising\",\n    \"src\": \"/static/ee8d9d2f8ab344e3eabd1088e07669a8/432e7/max-temperature-rising_temperature_test.png\",\n    \"srcSet\": [\"/static/ee8d9d2f8ab344e3eabd1088e07669a8/772e8/max-temperature-rising_temperature_test.png 200w\", \"/static/ee8d9d2f8ab344e3eabd1088e07669a8/e17e5/max-temperature-rising_temperature_test.png 400w\", \"/static/ee8d9d2f8ab344e3eabd1088e07669a8/432e7/max-temperature-rising_temperature_test.png 570w\"],\n    \"sizes\": \"(max-width: 570px) 100vw, 570px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Beautiful coordinated control as in the other cases: least to most drastic.\")), mdx(\"h3\", null, \"Falling Cell/Battery Temperature\"), mdx(\"p\", null, \"The purpose of this test is to verify the BMS takes protective action to communicate via CANBus to stop charging, communicate via the CHARGE ENABLE to stop charging if temperature gets near freezing.  It did.  Note, the BMS does not open the main contactor on low temperature (nor would you want it to). \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/1fd83ab4824fb456eddcb59c0bb2f436/rising_temperature_test.csv\"\n  }, \"CSV data\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"551px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0977b34d7c8c0576fdfff8bd0062af96/db783/min-temperature-falling_temperature_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"83.50000000000001%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAACmklEQVQ4y42UCY+cOBCF+///uChRrp20ZgYMbjA3NpjDhm9lSPf2arLSlvRw4fNVvVJd9n0nIJgZBuTtxu12QwhBmqaHHxD8LMtIkgQp5TGX5/mBZ7uET7hucw4/TUzGMFmL1hpjDH3fP8aAtm3puu7xH9a89we2beMS2LV1jf7xg/TzZ9IvX4jf3kgCCymZwiPTxDzP/0aY+702Woud5+OBS2BSKMXuHIO1mGmiiSJaKdHTxP+ybYN1xVrLJVAOYXwwpaDrzs1/snmGvoeigLKErseOI5d1XamqCu9Xts3h/XKMzjvWtsVJeaKuccbgmgaXprgsw3UdbpqOs4eoxpyiDMNAnrfkuUEpg8oNTWPQ43Ao39U1vZT0QtAJQd80dMbQaYM2mjzvyLNTpEtQp65brlfLy4vi06cr378nvLzECBGTppJ5Xli8/wfregizLDPDsCDEQtOsaG1OUULIoXhCuNYapslSFBPrGjCfOduf8GTjCNae/iHK3bkX992y7NxsDHj/URPnQqrgdgOtny4MxRgYrsuKXz3r4vCrY9COtnE0lUPEC2U5UxQzSp1jHC90jaOtHZN1bN7T95rLOI6UZYlQgiiPiLKIWMWIIjoga0GmKvJMk6ueLOtQuUaqgqSMkJUgVhFJkZyiLMtCWZUkTUIkI77+/Mqvt198++sbdd/Q2Y5yUEfyQjltu4N9I9cZ2mrMNGAmg10sZjAnw7Y5C3vfdpwL9De8OxPnd09l63P9qZGUY/Uhr0cOA0N9z+ofzG2OZmo+zFf2Py4McSuljioPBR7GB34X7jW7EhcxcRkTqejwX/PXx5lAKEQautDBMPS69/f3R7+798HgH3NpgkgFMpPESUwiE0Qijj2BzOvr67Ev9MO/AVSzGkuFktCQAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"min temp falling\",\n    \"title\": \"min temp falling\",\n    \"src\": \"/static/0977b34d7c8c0576fdfff8bd0062af96/db783/min-temperature-falling_temperature_test.png\",\n    \"srcSet\": [\"/static/0977b34d7c8c0576fdfff8bd0062af96/772e8/min-temperature-falling_temperature_test.png 200w\", \"/static/0977b34d7c8c0576fdfff8bd0062af96/e17e5/min-temperature-falling_temperature_test.png 400w\", \"/static/0977b34d7c8c0576fdfff8bd0062af96/db783/min-temperature-falling_temperature_test.png 551w\"],\n    \"sizes\": \"(max-width: 551px) 100vw, 551px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"The early and phased reduction in charge current limit was a surprise, but a good one.  LFP batteries do not like to be charged rapidly when cold.\")), mdx(\"h3\", null, \"Additional Random Thoughts\"), mdx(\"p\", null, \"The while not captured in the plots, the test scripts were closely comparing the voltages and temperatures when specific actions (e.g. open contactor) occurred to the settings in the BMS and manual.  In many cases, due to the time delay/hysteresis and logging delay they would be slightly and perhaps fail.  This is just a test artifact.  Even so, we found that if an action was supposed to occur at a specific cell voltage, it did within double-digit millivolts.  Good enough!  \"), mdx(\"p\", null, \"Some behavior could not be observed because we don't have a way to simulate draw down of the battery via the shunt.  This means we could only test behavior driven directly by cell voltage, which is ok, as these are the bounding cases.\"), mdx(\"p\", null, \"With the data we've acquired, we will be able to decode parts of the alarm/warning byte structure and improve our CANBus monitoring behavior.  We will need to do a little more testing to see if the alarm/warning bits are tied to specific cells or temperature sensors.\"), mdx(\"p\", null, \"We were surprised to see that the Charge Voltage Limit rises to track pack voltage when the contactor opens due to high cell voltage.  Not sure why, and not sure if it matters at all since the contactor is open.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"546px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/75aeb7464a3019d4cd1adf32634273bb/76aed/battery-voltage-rising_voltage_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"80.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACD0lEQVQ4y5VU17LrIAz0/3/fzUN6j0vihsF09oyUOMnJ7cxoAAktSFqRxRjhnYM1Bs45aK0xn8+xWCxwPB4xm82wXC6x3W6xXq+x2WxYt1qtsN/v4ZyH8wHWWnjvkTVNg7ysULYDLpcLDocDdrsdA7Rti2EYWIQQPEspnzqpFPSoIG9nGOvQ9z0yHwJk3wK6w/V65VsJkF5YFAXO5zPrxnHEr0byFtftD14rpZARSNd1rKDwU0qIMfGaJITAMtleEpHIRwsUhyUQLKQakVHcv7v9j4NACXDsUOQnRDNAEWBd15wfGj5EhPgXCRE+JoQHbhQFbmKE60uoUSOjuDnRJqCWBo2yP4skIZtDMwa00qKubyjOO5ihwW0wUG0JJQdk9DoC/LcwA6BbYCh4FkqjGiw6HaBFA9nXyKjURIF7WtJ3IR2J00jyiiQKJC2eNhpUMF6bHrJvkBGRKewJ8D3pMAMgCkBeAXcvXHqa0+N8+g5IlBkeRWFzDEhjgyTy+xzc66WfEbxF8gRk2mh9z89YA7IEjPh/GtkeigAnYjtRQYsa1nmmD6XCGMP9STPtqdenfp9s9AdoY2FVD9E1yAicQPOihAuRK346Hpmb5FxVFcqyZGey0YdBRSQb++U5nLV8Aek4h+RErUWZov6dqk4MICf+kbxn20QxOvPye43svbKf62lPX9PpdHru322fdPsCUivcEvsojdMAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"CVL behavior\",\n    \"title\": \"CVL behavior\",\n    \"src\": \"/static/75aeb7464a3019d4cd1adf32634273bb/76aed/battery-voltage-rising_voltage_test.png\",\n    \"srcSet\": [\"/static/75aeb7464a3019d4cd1adf32634273bb/772e8/battery-voltage-rising_voltage_test.png 200w\", \"/static/75aeb7464a3019d4cd1adf32634273bb/e17e5/battery-voltage-rising_voltage_test.png 400w\", \"/static/75aeb7464a3019d4cd1adf32634273bb/76aed/battery-voltage-rising_voltage_test.png 546w\"],\n    \"sizes\": \"(max-width: 546px) 100vw, 546px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"It also wiggles a bit when it first lowers.\")), mdx(\"p\", null, \"In addition to the report a max and min temperature, \\\"battery\\\" temperature is also reported over CANBus.  The \\\"battery\\\" temperature uses whatever of the three measured temperatures is highest.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"562px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/61d17d27167b754fe20bd1d12f175063/6e88f/battery-temperature-falling_temperature_test.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"77.99999999999999%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACQ0lEQVQ4y5WTi46bMBBF8//fVrVadbtJCISQBwkJIUB42NhwqjEJ291VpdbSMLbHc31nrpkBDMNAb3uKW85q6RGFG47xkZXnEfgBu+3W7fkrn120JQzWrP2AzTp0sf12x2B7jDHMjLUUeUGcJiziiG/rOd83S173PmES8hIteYl8t/cSefzYLPgZBXiHA95h//AHosuFvCiYdV3H7XajMx2VqWlM63xrFQMDqu8wQ09lGjdXvXbxe/duZVeNca2YSclt26K7ji9j4L+GUoqZfM6XC6atQJUMTc7QNQ5Levu0f0F3gONEo5sKTOsAqc48xXp60w+YR+PFJFnaJaa1dmccoCwuwtCY9yrvJ+jtg9PIsCoLrumFIAhYr9e8vb2xXC7xfZ9fr6/keU5d10+Gyt0yAaoSmmycS8n9QK1y8iIlDEM2mw2rlcd2GzGfL5gvPFbekiy7jiqnaeqo/1km94Sht9OetsYJJ5eLiZBKG9qmpr2dUNcdTV0xc+VU1VdAXUMZjwz/qkIx9lu8pOhuLFkAp5KfyspcVwzl8X099KOX/sp+c5tik8p931MUxSTKl2FaKI+g74+3aUbmVn85KqQcQym3LMvpOYxPwjwevEFLz7IDXX6iTbfo5o42lrZpXI7rp1KuUtfDOI6d7GL7/d4Fj8ejE0sOHeIYpTuS5ER6zaibhv1u54AkN0kSB+wYyhuUkmXxDAiw7Anz8/mMtZZrmpJlGdYad05ickYunYSEkeEHdT/9Ic8hTITRh1/9U47Yb38/1tYka3DOAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"batt temp is max temp\",\n    \"title\": \"batt temp is max temp\",\n    \"src\": \"/static/61d17d27167b754fe20bd1d12f175063/6e88f/battery-temperature-falling_temperature_test.png\",\n    \"srcSet\": [\"/static/61d17d27167b754fe20bd1d12f175063/772e8/battery-temperature-falling_temperature_test.png 200w\", \"/static/61d17d27167b754fe20bd1d12f175063/e17e5/battery-temperature-falling_temperature_test.png 400w\", \"/static/61d17d27167b754fe20bd1d12f175063/6e88f/battery-temperature-falling_temperature_test.png 562w\"],\n    \"sizes\": \"(max-width: 562px) 100vw, 562px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Was curious what they would do with multiple sensors.  This seems like the most practical thing.\")), mdx(\"p\", null, \"We need to decide on our final protection parameters.  The default high cell voltage cutoff (3.85V) seems high, so we might back that down and lower the hysteresis accordingly.  The default low temperature charging cutoff (-10C) is also a low, and we might set slightly above freezing.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"REC BMS Testing","cover":{"img":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/beeb8216d86d7877cc44aa9ea1bda241/6b6ee/mhmv2bmsctf-cover.jpg","srcSet":"/static/beeb8216d86d7877cc44aa9ea1bda241/f6013/mhmv2bmsctf-cover.jpg 320w,\n/static/beeb8216d86d7877cc44aa9ea1bda241/f5c5d/mhmv2bmsctf-cover.jpg 640w,\n/static/beeb8216d86d7877cc44aa9ea1bda241/6b6ee/mhmv2bmsctf-cover.jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/beeb8216d86d7877cc44aa9ea1bda241/18ae9/mhmv2bmsctf-cover.webp 320w,\n/static/beeb8216d86d7877cc44aa9ea1bda241/d1bc6/mhmv2bmsctf-cover.webp 640w,\n/static/beeb8216d86d7877cc44aa9ea1bda241/e07de/mhmv2bmsctf-cover.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":792}}}}}}},"pageContext":{"slug":"/blog/2021-8-5-bms-testing/bms-testing/"}},"staticQueryHashes":["2882470331","3528462622","3692595610"]}